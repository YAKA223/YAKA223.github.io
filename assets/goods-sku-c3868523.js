import{_ as x,m as C,o as r,a as l,F as k,g as b,b as y,t as S,d as E,k as P}from"./_plugin-vue_export-helper-9e9db05b.js";function V(u){const f=[],c=2**u.length;for(let i=0;i<c;i+=1){const p=[];for(let g=0;g<u.length;g+=1)i&1<<g&&p.push(u[g]);f.push(p)}return f}const N={key:0,class:"goods-sku"},$=["onClick","src","title"],j=["onClick"],w={__name:"goods-sku",props:{goods:{type:Object,default:()=>({})},skuId:{type:String,default:""}},emits:["change"],setup(u,{emit:f}){const c=u;C({});const i=(d,t)=>{if(t.disabled)return;t.selected?t.selected=!1:(d.values.forEach(e=>{e.selected=!1}),t.selected=!0),_(c.goods.specs,h);const s=m(c.goods.specs).filter(e=>e);if(s.length===c.goods.specs.length){const e=h[s.join(p)],n=c.goods.skus.find(o=>o.id===e[0]);f("change",{skuId:n.id,price:n.price,oldPrice:n.oldPrice,inventory:n.inventory,specsText:n.specs.reduce((o,a)=>`${o} ${a.name}: ${a.valueName}`,"").trim()})}else f("change",{})},p="â˜…",h=(d=>{const t={};return d.forEach(s=>{if(s.inventory>0){const e=s.specs.map(o=>o.valueName);V(e).forEach(o=>{const a=o.join(p);t[a]?t[a].push(s.id):t[a]=[s.id]})}}),t})(c.goods.skus),m=d=>{const t=[];return d.forEach(s=>{const e=s.values.find(n=>n.selected);t.push(e?e.name:void 0)}),t},_=(d,t)=>{d.forEach((s,e)=>{const n=m(d);s.values.forEach(o=>{if(o.selected)return;n[e]=o.name;const a=n.filter(I=>I).join(p);o.disabled=!t[a]})})};_(c.goods.specs,h);const v=(d,t)=>{const s=d.skus.find(e=>e.id==t);d.specs.forEach((e,n)=>{const o=e.values.find(a=>a.name==s.specs[n].valueName);o.selected=!0})};return c.skuId&&v(c.goods,c.skuId),(d,t)=>u.goods?(r(),l("div",N,[(r(!0),l(k,null,b(c.goods.specs,s=>(r(),l("dl",{key:s.id},[y("dt",null,S(s.name),1),y("dd",null,[(r(!0),l(k,null,b(s.values,e=>(r(),l(k,{key:e.name},[e.picture?(r(),l("img",{key:0,onClick:n=>i(s,e),class:E({selected:e.selected,disabled:e.disabled}),src:e.picture,title:e.name},null,10,$)):(r(),l("span",{key:1,onClick:n=>i(s,e),class:E({selected:e.selected,disabled:e.disabled})},S(e.name),11,j))],64))),128))])]))),128))])):P("",!0)}},M=x(w,[["__scopeId","data-v-d256745f"]]);export{M as G};
