import{g as D,G as E}from"./goods-relevant-d7a9e3c7.js";import{_ as P,r as k,o as c,a as i,b as t,U as a,h as d,V as h,p as j,i as L,e as g,t as r,c as N,k as b,F as A,g as T}from"./_plugin-vue_export-helper-9e9db05b.js";import{o as F}from"./index-73f0c727.js";import{G as O}from"./goods-sku-c3868523.js";import{u as U}from"./vuex.esm-bundler-3cb7d60a.js";import{r as V}from"./runtime-dom.esm-bundler-3d397fb5.js";import{a as z}from"./xtx-confirm-26158c77.js";import"./index-8929c8ab.js";import"./index-37406977.js";const q=""+new URL("none-5c042de4.png",import.meta.url).href;const H={},R=n=>(j("data-v-7db9f97c"),n=n(),L(),n),J={class:"cart-none"},K=R(()=>t("img",{src:q,alt:""},null,-1)),M=R(()=>t("p",null,"购物车内暂时没有商品",-1)),Q={class:"btn"};function W(n,l){const p=k("XtxBotton");return c(),i("div",J,[K,M,t("div",Q,[a(p,{type:"primary",onClick:l[0]||(l[0]=_=>n.$router.push("/"))},{default:d(()=>[h("继续逛逛")]),_:1})])])}const Y=P(H,[["render",W],["__scopeId","data-v-7db9f97c"]]);const Z=n=>(j("data-v-3e215f50"),n=n(),L(),n),tt={class:"ellipsis"},et=Z(()=>t("i",{class:"iconfont icon-angle-down"},null,-1)),st={key:0,class:"layer"},nt={key:0,class:"loading"},at={__name:"cart-sku",props:{attrsText:{type:String,default:""},skuId:{type:String,default:""}},emits:["change"],setup(n,{emit:l}){const p=n,_=g(!1),m=g(null),y=g(!1),$=()=>{_.value=!0,y.value=!0,D(p.skuId).then(f=>{m.value=f.result})},I=()=>{_.value=!1,m.value=null},s=()=>{_.value?I():$()},o=g(null);F(o,()=>{I()});const v=g(null),B=f=>{v.value=f},C=()=>{v.value&&v.value.skuId&&v.value.skuId!==p.skuId&&(l("change",v.value),I())};return(f,S)=>{const X=k("XtxBotton");return c(),i("div",{class:"cart-sku",ref_key:"target",ref:o},[t("div",{class:"attrs",onClick:S[0]||(S[0]=e=>s())},[t("span",tt,r(n.attrsText),1),et]),_.value?(c(),i("div",st,[m.value?(c(),N(O,{key:1,goods:m.value,skuId:n.skuId,onChange:B},null,8,["goods","skuId"])):(c(),i("div",nt)),m.value?(c(),N(X,{key:2,type:"primary",size:"mini",style:{"margin-left":"60px"},onClick:C},{default:d(()=>[h("确认")]),_:1})):b("",!0)])):b("",!0)],512)}}},ot=P(at,[["__scopeId","data-v-3e215f50"]]),w=document.createElement("div");w.setAttribute("class","xtx-confirm-container");document.body.appendChild(w);const G=({title:n,text:l})=>new Promise((p,_)=>{const $=a(z,{title:n,text:l,submitCallback:()=>{V(null,w),p()},cancelCallback:()=>{V(null,w),_(new Error("点击取消"))}});V($,w)});const u=n=>(j("data-v-5a662d48"),n=n(),L(),n),ct={class:"xtx-cart-page"},lt={class:"container"},rt={class:"cart"},it={width:"120"},dt=u(()=>t("th",{width:"400"},"商品信息",-1)),ut=u(()=>t("th",{width:"220"},"单价",-1)),_t=u(()=>t("th",{width:"180"},"数量",-1)),ht=u(()=>t("th",{width:"180"},"小计",-1)),pt=u(()=>t("th",{width:"140"},"操作",-1)),mt={key:0},vt={colspan:"6"},kt={class:"goods"},ft=["src"],Ct={class:"name ellipsis"},xt={class:"tc"},yt={key:0},$t={class:"red"},It={class:"tc"},gt={class:"tc"},bt={class:"f16 red"},wt={class:"tc"},St=u(()=>t("p",null,[t("a",{href:"javascript:;"},"移入收藏夹")],-1)),Bt=["onClick"],Xt=u(()=>t("p",null,[t("a",{href:"javascript:;"},"找相似")],-1)),Vt={key:0},Pt=u(()=>t("tr",null,[t("td",{colspan:"6"},[t("h3",{class:"tit"},"失效商品")])],-1)),jt={class:"goods"},Lt=["src"],Nt={class:"name ellipsis"},At={class:"attr"},Tt={class:"tc"},Gt={class:"tc"},Rt={class:"tc"},Dt=u(()=>t("td",{class:"tc"},[t("p",null,[t("a",{class:"green",href:"javascript:;"},"删除")]),t("p",null,[t("a",{href:"javascript:;"},"找相似")])],-1)),Et={class:"action"},Ft={class:"batch"},Ot=u(()=>t("a",{href:"javascript:;"},"移入收藏夹",-1)),Ut={class:"total"},zt={class:"red"},qt={__name:"index",setup(n){const l=U(),p=(s,o)=>{l.dispatch("cart/updateCart",{skuId:s,selected:o})},_=s=>{l.dispatch("cart/checkAllCart",s)},m=s=>{G({text:"确认删除商品？"}).then(()=>{l.dispatch("cart/deleteCart",s)}).catch(o=>{})},y=s=>{G({text:`您确定从购物车删除${s?"失效":"选中"}的商品吗？`}).then(()=>{l.dispatch("cart/batchDeleteCart",s)}).catch(o=>{})},$=(s,o)=>{l.dispatch("cart/updateCart",{skuId:s,count:o})},I=(s,o)=>{l.dispatch("cart/updateCartSku",{oldSkuId:s,newSku:o})};return(s,o)=>{const v=k("XtxBreadItem"),B=k("XtxBread"),C=k("XtxCheckBox"),f=k("RouterLink"),S=k("XtxNumbox"),X=k("XtxBotton");return c(),i("div",ct,[t("div",lt,[a(B,null,{default:d(()=>[a(v,{to:"/"},{default:d(()=>[h("首页")]),_:1}),a(v,null,{default:d(()=>[h("购物车")]),_:1})]),_:1}),t("div",rt,[t("table",null,[t("thead",null,[t("tr",null,[t("th",it,[a(C,{modelValue:s.$store.getters["cart/isCheckAll"],onChange:_},{default:d(()=>[h("全选 ")]),_:1},8,["modelValue"])]),dt,ut,_t,ht,pt])]),t("tbody",null,[s.$store.getters["cart/validList"].length===0?(c(),i("tr",mt,[t("td",vt,[a(Y)])])):b("",!0),(c(!0),i(A,null,T(s.$store.getters["cart/validList"],e=>(c(),i("tr",{key:e.skuId},[t("td",null,[a(C,{modelValue:e.selected,onChange:x=>p(e.skuId,x)},null,8,["modelValue","onChange"])]),t("td",null,[t("div",kt,[a(f,{to:`/product/${e.id}`},{default:d(()=>[t("img",{src:e.picture,alt:""},null,8,ft)]),_:2},1032,["to"]),t("div",null,[t("p",Ct,r(e.name),1),a(ot,{"attrs-text":e.attrsText,skuId:e.skuId,onChange:x=>I(e.skuId,x)},null,8,["attrs-text","skuId","onChange"])])])]),t("td",xt,[t("p",null,"¥"+r(e.nowPrice),1),e.Price-e.nowPrice?(c(),i("p",yt,[h("比加入时降价 "),t("span",$t,"¥"+r(e.Price-e.nowPrice),1)])):b("",!0)]),t("td",It,[a(S,{modelValue:e.count,max:e.stock,onChange:x=>$(e.skuId,x)},null,8,["modelValue","max","onChange"])]),t("td",gt,[t("p",bt,"¥"+r(e.nowPrice*e.count),1)]),t("td",wt,[St,t("p",null,[t("a",{class:"green",href:"javascript:;",onClick:x=>m(e.skuId)},"删除",8,Bt)]),Xt])]))),128))]),s.$store.getters["cart/invalidList"]?(c(),i("tbody",Vt,[Pt,(c(!0),i(A,null,T(s.$store.getters["cart/invalidList"],e=>(c(),i("tr",{key:e.skuId},[t("td",null,[a(C,{style:{color:"#eee"}})]),t("td",null,[t("div",jt,[a(f,{to:`/product/${e.id}`},{default:d(()=>[t("img",{src:e.picture,alt:""},null,8,Lt)]),_:2},1032,["to"]),t("div",null,[t("p",Nt,r(e.name),1),t("p",At,r(e.attrsText),1)])])]),t("td",Tt,[t("p",null,"¥"+r(e.nowPrice),1)]),t("td",Gt,r(e.count),1),t("td",Rt,[t("p",null,"¥"+r(e.nowPrice*e.count),1)]),Dt]))),128))])):b("",!0)])]),t("div",Et,[t("div",Ft,[a(C,{modelValue:s.$store.getters["cart/isCheckAll"]},{default:d(()=>[h("全选")]),_:1},8,["modelValue"]),t("a",{href:"javascript:;",onClick:o[0]||(o[0]=e=>y())},"删除商品"),Ot,t("a",{href:"javascript:;",onClick:o[1]||(o[1]=e=>y(!0))},"清空失效商品")]),t("div",Ut,[h(" 共 "+r(s.$store.getters["cart/validTotal"])+" 件商品，已选择 "+r(s.$store.getters["cart/selectedTotal"])+" 件，商品合计： ",1),t("span",zt,r(s.$store.getters["cart/selectedAmount"]),1),a(X,{type:"primary"},{default:d(()=>[h("下单结算")]),_:1})])]),a(E)])])}}},ee=P(qt,[["__scopeId","data-v-5a662d48"]]);export{ee as default};
