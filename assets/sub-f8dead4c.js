import{e as I,u as D}from"./vuex.esm-bundler-3cb7d60a.js";import{c as L,d as j}from"./index-8929c8ab.js";import{_ as w,l as B,e as y,w as V,r as k,o as r,a as d,b as n,F as S,g as $,d as h,t as b,k as X,U as i,p as A,i as G,m as T,V as g,h as m,u as F,c as U}from"./plugin-vue_export-helper-9e9db05b.js";import{G as z}from"./goods-item-9255c7ed.js";const E=f=>(A("data-v-332607dc"),f=f(),G(),f),q={key:0,class:"sub-filter"},R={key:0,class:"item"},H=E(()=>n("div",{class:"head"},"品牌：",-1)),J={class:"body"},K=["onClick"],O={class:"head"},Q={class:"body"},W=["onClick"],Y={key:1,class:"sub-filter"},Z={__name:"sub-filter",setup(f,{emit:x}){const c=I(),e=B(()=>c.params.id),l=y(null),u=y(!0);V(()=>c.params.id,o=>{u.value=!0,o&&c.fullPath.includes("sub")&&L(e.value).then(({result:a})=>{a.slectedBrand=null,a.brands.unshift({id:null,name:"全部"}),a.saleProperties.forEach(_=>{_.slectedAttr=null,_.properties.unshift({id:null,name:"全部"})}),l.value=a,u.value=!1})},{immediate:!0});const p=o=>{(l.value.slectedBrand=o)||(l.value.slectedBrand=o)},t=(o,a)=>{(o.slectedAttr=a)||(o.slectedAttr=a)};return(o,a)=>{const _=k("XtxSkeleton");return l.value&&l.value.brands&&l.value.saleProperties&&!u.value?(r(),d("div",q,[l.value.brands?(r(),d("div",R,[H,n("div",J,[(r(!0),d(S,null,$(l.value.brands,s=>(r(),d("a",{href:"javascript:;",class:h({active:s.id==l.value.slectedBrand}),onClick:v=>p(s.id)},b(s.name),11,K))),256))])])):X("",!0),(r(!0),d(S,null,$(l.value.saleProperties,s=>(r(),d("div",{class:"item",key:s.id},[n("div",O,b(s.name)+"：",1),n("div",Q,[(r(!0),d(S,null,$(s.properties,v=>(r(),d("a",{href:"javascript:;",key:v.id,class:h({active:v.id==s.slectedAttr}),onClick:C=>t(s,v.id)},b(v.name),11,W))),128))])]))),128))])):(r(),d("div",Y,[i(_,{class:"item",width:"800px",height:"40px"}),i(_,{class:"item",width:"800px",height:"40px"}),i(_,{class:"item",width:"600px",height:"40px"}),i(_,{class:"item",width:"600px",height:"40px"}),i(_,{class:"item",width:"600px",height:"40px"})]))}}},ee=w(Z,[["__scopeId","data-v-332607dc"]]);const te={class:"sub-sort"},se={class:"sort"},oe={class:"check"},ae={__name:"sub-sort",setup(f,{emit:x}){const c=I(),e=T({inventory:!1,onlyDiscount:!1,sortField:null,sortMethod:null});V(()=>c.params.id,()=>{e.inventory=e.onlyDiscount=!1,e.sortField=e.sortMethod=null});const l=p=>{const t=e.sortField;e.sortField=p,p=="price"?e.sortMethod==null||e.sortMethod=="asc"?e.sortMethod="desc":e.sortMethod="asc":e.sortMethod!==null&&(e.sortMethod=null),(t!==e.sortField||e.sortField==="price")&&x("sort-change",e)},u=()=>{x("sort-change",e)};return(p,t)=>{const o=k("XtxCheckBox");return r(),d("div",te,[n("div",se,[n("a",{class:h({active:e.sortField==null}),onClick:t[0]||(t[0]=a=>l()),href:"javascript:;"},"默认排序",2),n("a",{class:h({active:e.sortField=="publishTime"}),onClick:t[1]||(t[1]=a=>l("publishTime")),href:"javascript:;"},"最新商品",2),n("a",{class:h({active:e.sortField=="orderNum"}),onClick:t[2]||(t[2]=a=>l("orderNum")),href:"javascript:;"},"最高人气",2),n("a",{class:h({active:e.sortField=="evaluateNum"}),onClick:t[3]||(t[3]=a=>l("evaluateNum")),href:"javascript:;"},"评论最多",2),n("a",{onClick:t[4]||(t[4]=a=>l("price")),href:"javascript:;"},[g(" 价格排序 "),n("i",{class:h(["arrow up",{active:e.sortField=="price"&&e.sortMethod=="asc"}])},null,2),n("i",{class:h(["arrow down",{active:e.sortField=="price"&&e.sortMethod=="desc"}])},null,2)])]),n("div",oe,[i(o,{onChange:u,modelValue:e.inventory,"onUpdate:modelValue":t[5]||(t[5]=a=>e.inventory=a)},{default:m(()=>[g("仅显示有货商品")]),_:1},8,["modelValue"]),i(o,{onChange:u,modelValue:e.onlyDiscount,"onUpdate:modelValue":t[6]||(t[6]=a=>e.onlyDiscount=a)},{default:m(()=>[g("仅显示特惠商品")]),_:1},8,["modelValue"])])])}}},le=w(ae,[["__scopeId","data-v-916fea3c"]]);const ne={class:"container"},re={class:"goods-list"},ie={__name:"sub",setup(f){const x=D(),c=I(),e=B(()=>x.state.category.list.find(s=>s.id==c.fullPath.split("/")[c.fullPath.split("/").findIndex(v=>v=="category")+1])),l=B(()=>e.value.children.find(s=>s.id==c.params.id)),u=y(!1),p=y(!1),t=y([]);let o={page:1,pageSize:20};const a=()=>{p.value=!0,o.categoryId=c.params.id,j(o).then(({result:s})=>{s.items.length?(t.value=[...t.value,...s.items],o.page+=1):u.value=!0}),p.value=!1};V(()=>c.params.id,s=>{s&&(t.value=[],o.page=1,u.value=!1)});const _=s=>{t.value=[],u.value=!1,o={...o,...s},o.page=1};return(s,v)=>{const C=k("XtxBreadItem"),P=k("XtxBread"),N=k("XtxInfiniteLoading");return r(),d("div",ne,[F(e)?(r(),U(P,{key:0},{default:m(()=>[i(C,{to:"/"},{default:m(()=>[g("首页")]),_:1}),i(C,{to:`/category/${F(e).id}`},{default:m(()=>[g(b(F(e).name),1)]),_:1},8,["to"]),i(C,null,{default:m(()=>[g(b(F(l).name),1)]),_:1})]),_:1})):X("",!0),i(ee),n("div",re,[i(le,{onSortChange:_}),n("ul",null,[(r(!0),d(S,null,$(t.value,M=>(r(),d("li",{key:M},[i(z,{goodsList:M},null,8,["goodsList"])]))),128))]),i(N,{onInfnite:a,loading:p.value,finished:u.value},null,8,["loading","finished"])])])}}},pe=w(ie,[["__scopeId","data-v-1af2fa88"]]);export{pe as default};
